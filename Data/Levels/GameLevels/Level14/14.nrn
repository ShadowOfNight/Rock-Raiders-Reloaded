#include <nerpnrn.h>

_GetCrystalsCurrentlyStored() > 19 ? _SetLevelCompleted()

Main()
{
	TRUE ? SetTutorialFlags 0
	TRUE ? SetMessagePermit 1

	Func(CheckCompleteFail)
	{
		// Should Rock-Monsters emerge???
		GetMonstersOnLevel > 2 ? goto(jump)
//////////////////
		GetRecordObjectAtTutorial 31 > 0 ? SetRockMonsterAtTutorial 1
		//
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 31 > 0 ? SetCongregationAtTutorial 11 1
//////////////////
		GetRecordObjectAtTutorial 32 > 0 ? SetRockMonsterAtTutorial 2
		//
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 32 > 0 ? SetCongregationAtTutorial 12 1
//////////////////
		GetRecordObjectAtTutorial 33 > 0 ? SetRockMonsterAtTutorial 3
		//
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 33 > 0 ? SetCongregationAtTutorial 13 1
//////////////////
		GetRecordObjectAtTutorial 34 > 0 ? SetRockMonsterAtTutorial 4
		//
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 34 > 0 ? SetCongregationAtTutorial 14 1
//////////////////
		GetRecordObjectAtTutorial 35 > 0 ? SetRockMonsterAtTutorial 5
		//
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 35 > 0 ? SetCongregationAtTutorial 15 1
//////////////////
		GetRecordObjectAtTutorial 36 > 0 ? SetRockMonsterAtTutorial 6
		//
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 36 > 0 ? SetCongregationAtTutorial 16 1
//////////////////
		GetRecordObjectAtTutorial 37 > 0 ? SetRockMonsterAtTutorial 7
		//
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 37 > 0 ? SetCongregationAtTutorial 17 1
//////////////////
		GetRecordObjectAtTutorial 38 > 0 ? SetRockMonsterAtTutorial 8
		//
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 18 1
//////////////////
		GetRecordObjectAtTutorial 38 > 0 ? SetRockMonsterAtTutorial 9
		//
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 11 0
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 12 0
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 13 0
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 14 0
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 15 0
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 16 0
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 17 0
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 18 0
		GetRecordObjectAtTutorial 39 > 0 ? SetCongregationAtTutorial 19 0
		//
		GetRecordObjectAtTutorial 38 > 0 ? SetCongregationAtTutorial 19 1
jump:
		// Check for failure
		_GetOxygenLevel() = 0 ? SetLevelFail
		_GetMiniFiguresOnLevel() < 5 ? SetLevelFail
		// Check for completion
		TRUE ? _SetR1(0)
		_GetRecordObjectAtTutorial(21) > 0 ? _AddR1(1)
		_GetRecordObjectAtTutorial(22) > 0 ? _AddR1(1)
		GetR1 = 0 ? Stop
		// Trigger Message
		TRUE ? _SetMessagePermit(0)
		TRUE ? _SetMessage(1,1)
	}
	FuncEnd(CheckCompleteFail)

	Function(PlayMessage)
	{
		// Check for failure
		_GetOxygenLevel() = 0 ? SetLevelFail
		// Check for toolstore+minifigure removal
		_GetMiniFiguresOnLevel() > 0 ? :canrebuild1
		_GetToolStoresBuilt() = 0 ? SetLevelFail
canrebuild1:
		// Wait for message end
		_GetMessageTimer() > 0 ? Stop
		TRUE ? _SetMessagePermit(1)
	}
	FuncEnd(PlayMessage)

	Function(WaitForCrystals)
	{
		// Check for failure
		_GetOxygenLevel() = 0 ? SetLevelFail
		// Check for toolstore+minifigure removal
		_GetMiniFiguresOnLevel() > 0 ? :canrebuild2
		_GetToolStoresBuilt() = 0 ? SetLevelFail
canrebuild2:
		// Check for crystals
		_GetCrystalsCurrentlyStored() > 19 ? _SetLevelCompleted()
		Stop
	}
	FuncEnd(WaitForCrystals)
}
MainEnd()